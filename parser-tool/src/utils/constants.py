"""
Constants and bugcheck code definitions for BSOD Parser Tool.
"""

# Application metadata
APP_NAME = "BSOD Parser Tool"
APP_VERSION = "1.0.0"

# Supported dump file extensions
SUPPORTED_EXTENSIONS = [".dmp", ".DMP"]

# Output file names
OUTPUT_FILENAME = "crash_report.zip"
CRASH_SUMMARY_FILE = "crash_summary.json"
STACK_TRACE_FILE = "stack_trace.json"
DRIVER_LIST_FILE = "driver_list.json"
SYSTEM_INFO_FILE = "system_info.json"

# Common Windows bugcheck codes and their names
BUGCHECK_CODES = {
    0x00000001: "APC_INDEX_MISMATCH",
    0x0000000A: "IRQL_NOT_LESS_OR_EQUAL",
    0x0000001A: "MEMORY_MANAGEMENT",
    0x0000001E: "KMODE_EXCEPTION_NOT_HANDLED",
    0x00000024: "NTFS_FILE_SYSTEM",
    0x0000002E: "DATA_BUS_ERROR",
    0x0000003B: "SYSTEM_SERVICE_EXCEPTION",
    0x0000003F: "NO_MORE_SYSTEM_PTES",
    0x00000050: "PAGE_FAULT_IN_NONPAGED_AREA",
    0x0000007A: "KERNEL_DATA_INPAGE_ERROR",
    0x0000007E: "SYSTEM_THREAD_EXCEPTION_NOT_HANDLED",
    0x0000007F: "UNEXPECTED_KERNEL_MODE_TRAP",
    0x0000008E: "KERNEL_MODE_EXCEPTION_NOT_HANDLED",
    0x0000009C: "MACHINE_CHECK_EXCEPTION",
    0x0000009F: "DRIVER_POWER_STATE_FAILURE",
    0x000000BE: "ATTEMPTED_WRITE_TO_READONLY_MEMORY",
    0x000000C2: "BAD_POOL_CALLER",
    0x000000C4: "DRIVER_VERIFIER_DETECTED_VIOLATION",
    0x000000C5: "DRIVER_CORRUPTED_EXPOOL",
    0x000000D1: "DRIVER_IRQL_NOT_LESS_OR_EQUAL",
    0x000000D8: "DRIVER_USED_EXCESSIVE_PTES",
    0x000000EA: "THREAD_STUCK_IN_DEVICE_DRIVER",
    0x000000ED: "UNMOUNTABLE_BOOT_VOLUME",
    0x000000F4: "CRITICAL_OBJECT_TERMINATION",
    0x000000FC: "ATTEMPTED_EXECUTE_OF_NOEXECUTE_MEMORY",
    0x000000FE: "BUGCODE_USB_DRIVER",
    0x00000101: "CLOCK_WATCHDOG_TIMEOUT",
    0x00000109: "CRITICAL_STRUCTURE_CORRUPTION",
    0x00000116: "VIDEO_TDR_FAILURE",
    0x00000119: "VIDEO_SCHEDULER_INTERNAL_ERROR",
    0x0000011A: "VIDEO_SHADOW_DRIVER_FATAL_ERROR",
    0x0000011B: "DRIVER_RETURNED_HOLDING_CANCEL_LOCK",
    0x0000011D: "EVENT_TRACING_FATAL_ERROR",
    0x00000124: "WHEA_UNCORRECTABLE_ERROR",
    0x00000133: "DPC_WATCHDOG_VIOLATION",
    0x00000139: "KERNEL_SECURITY_CHECK_FAILURE",
    0x0000013A: "KERNEL_MODE_HEAP_CORRUPTION",
    0x00000154: "UNEXPECTED_STORE_EXCEPTION",
    0x0000015F: "CONNECTED_STANDBY_WATCHDOG_TIMEOUT",
    0x00000187: "VIDEO_DWMINIT_TIMEOUT_FALLBACK_BDD",
    0x00000189: "BAD_OBJECT_HEADER",
    0x0000018B: "SECURE_FAULT_UNHANDLED",
    0x0000018E: "KERNEL_PARTITION_REFERENCE_VIOLATION",
    0x00000196: "LOADER_ROLLBACK_DETECTED",
    0x0000019B: "TTM_FATAL_ERROR",
    0x000001A0: "TTM_WATCHDOG_TIMEOUT",
    0x000001C4: "DRIVER_VERIFIER_DETECTED_VIOLATION_LIVEDUMP",
    0x000001C6: "FAST_ERESOURCE_PRECONDITION_VIOLATION",
    0x000001C7: "STORE_DATA_STRUCTURE_CORRUPTION",
    0x000001C8: "MANUALLY_INITIATED_POWER_BUTTON_HOLD",
    0x000001CA: "SYNTHETIC_WATCHDOG_TIMEOUT",
    0x000001CB: "INVALID_SILO_DETACH",
    0x000001CC: "EXRESOURCE_TIMEOUT_LIVEDUMP",
    0x000001CD: "INVALID_CALLBACK_STACK_ADDRESS",
    0x000001CE: "INVALID_KERNEL_STACK_ADDRESS",
    0x000001CF: "HARDWARE_WATCHDOG_TIMEOUT",
    0x000001D0: "CPI_FIRMWARE_WATCHDOG_TIMEOUT",
    0x000001D2: "WORKER_THREAD_INVALID_STATE",
    0x000001D5: "DRIVER_PNP_WATCHDOG",
    0x000001D6: "WORKER_THREAD_RETURNED_WITH_NON_DEFAULT_WORKLOAD_CLASS",
    0x000001D7: "EFS_FATAL_ERROR",
    0x000001D8: "UCMUCSI_FAILURE",
    0x000001D9: "HAL_IOMMU_INTERNAL_ERROR",
    0x000001DA: "HAL_BLOCKED_PROCESSOR_INTERNAL_ERROR",
    0x000001DB: "IPI_WATCHDOG_TIMEOUT",
    0x000001DC: "DMA_COMMON_BUFFER_VECTOR_ERROR",
    0x00000356: "XBOX_ERACTRL_CS_TIMEOUT",
}


def get_bugcheck_name(code: int) -> str:
    """
    Get the human-readable name for a bugcheck code.
    
    Args:
        code: The bugcheck code (e.g., 0x0000000A)
        
    Returns:
        The bugcheck name or "UNKNOWN_BUGCHECK" if not found
    """
    return BUGCHECK_CODES.get(code, "UNKNOWN_BUGCHECK")


def format_bugcheck_code(code: int) -> str:
    """
    Format a bugcheck code as a hexadecimal string.
    
    Args:
        code: The bugcheck code as an integer
        
    Returns:
        Formatted string like "0x0000000A"
    """
    return f"0x{code:08X}"
